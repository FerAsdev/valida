/**
 * Valida - jQuery plugin to validate forms in a as simple as possible way.  
 * Copyright (c) 2011-2013, Rogério Taques. 
 *
 * Licensed under MIT license:
 * http://www.opensource.org/licenses/mit-license.php
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy of this 
 * software and associated documentation files (the "Software"), to deal in the Software 
 * without restriction, including without limitation the rights to use, copy, modify, merge, 
 * publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons 
 * to whom the Software is furnished to do so, subject to the following conditions:
 * 
 * The above copyright notice and this permission notice shall be included in all copies or 
 * substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING 
 * BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND 
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, 
 * DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, 
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 *
 * @requires jQuery v1.9 or above
 * @version 2.1.4
 * @cat Plugins/Form Validation
 * @author Rogério Taques (rogerio.taques@gmail.com)
 * @see https://github.com/rogeriotaques/valida
 * 
 * Contributors:
 * - Kosuke Hiraga (hiraga@brijcs.co.jp)
 */
!function($){"use strict";function _partial_validation(el,show_error,force_clear,prev_state){var err=void 0===prev_state?!1:prev_state;return show_error=void 0===show_error?!0:show_error,force_clear=void 0===force_clear?!0:force_clear,el="object"==typeof el?el:$(el),force_clear&&_clear(el),!el.length||_ignore_this_element(el)?!1:(el.is("[required]")&&(!el.is("[type=checkbox]")&&""==el.val()||el.is("[type=checkbox]")&&!el.is(":checked")||el.is("select")&&!el.find("option:selected").length)?(err=!0,show_error&&_show_error(el,el.is("[type=checkbox]"))):o.use_filter&&el.attr("filter")&&!_is_filter_valid(el)&&(err=!0,show_error&&_show_warning(el,el.is("[type=checkbox]"))),!err)}function _typing_handler(el){var is_filter_valid=!_is_filter_valid(el,o);o.use_filter&&el.attr("filter")&&is_filter_valid?_show_warning(el,el.is("[type=checkbox]")):""!==el.val()&&el.attr("filter")&&!is_filter_valid?_show_success(el,el.is("[type=checkbox]")):_clear(el)}function _char_count(e,el,max){return el.val().length>max?void e.preventDefault():void el.siblings(".at-description").find("span.at-counter").html(el.val().length)}function _is_filter_valid(el){var list=void 0!==el.attr("filter")&&-1!==el.attr("filter").indexOf("|")?el.attr("filter").split("|"):[el.attr("filter")],pattern=/^(\w\d)+/,error=!1,i=0;for(i in list)if(pattern=list[i],"undefined"!=typeof pattern&&-1!==pattern.indexOf(":")){if(pattern=list[i].split(":"),error=""!==el.val()&&!("undefined"!=typeof filters[pattern[0]]&&filters[pattern[0]](el.val(),el.parents("form").find("#"+pattern[1]).val()||pattern[1])))break}else if(pattern=filters[pattern],error=""!==el.val()&&!el.val().match(pattern))break;return!error}function _show_success(el,is_checkbox){_clear(el),el.addClass("at-success"),el.closest(".form-group").addClass("has-success").addClass("has-feedback"),!is_checkbox&&el.is(":visible")&&el.after($("<span />",{"class":"glyphicon glyphicon-ok form-control-feedback"}))}function _show_warning(el,is_checkbox){var msg=el.data("invalid")||(o.messages.invalid?o.messages.invalid:"This field has invalid data"),place=el.data("place-after")||el;_clear(el),el.addClass("at-invalid"),el.closest(".form-group").addClass("has-warning").addClass("has-feedback"),is_checkbox?el.parent("label").after($("<span />",{"class":"at-warning",html:msg})):($(place).after($("<"+(o.tag?o.tag:"p")+"/>",{"class":"at-warning",html:msg})),el.is(":visible")&&$(place).after($("<span />",{"class":"glyphicon glyphicon-warning-sign form-control-feedback"})))}function _show_error(el,is_checkbox){var msg=el.data("required")||(o.messages.required?o.messages.required:"This field is required"),place=el.data("place-after")||el,place_for_msg=el.data("place-after")||(el.closest(".form-group").hasClass("input-group")?el.closest(".form-group"):el);_clear(el),el.addClass("at-required"),el.closest(".form-group").addClass("has-error").addClass("has-feedback"),is_checkbox?(el.parent().find(".at-error,.at-warning,.at-info,.at-success").remove(),el.next("label").after($("<span />",{"class":"at-error",html:"&nbsp;"+msg}))):($(place_for_msg).after($("<"+(o.tag?o.tag:"p")+"/>",{"class":"at-error",html:msg})),el.is(":visible")&&$(place).after($("<span />",{"class":"glyphicon glyphicon-remove form-control-feedback"})))}function _clear(el){el.removeClass("at-required at-invalid at-success"),el.is("[type=checkbox]")?el.siblings(".form-control-feedback, .at-error, .at-warning, .at-info, .at-success").remove():(el.closest(".form-group").hasClass("input-group")&&el.closest(".form-group").siblings(".form-control-feedback, .at-error, .at-warning, .at-info").remove(),el.closest(".form-group").removeClass("has-error has-warning has-success has-feedback"),el.siblings(".form-control-feedback, .at-error, .at-warning, .at-info, .at-success").remove())}function _clear_all(){$(".at-error, .at-warning, .at-info, .form-control-feedback").remove(),$(".at-required, .at-invalid, .at-success, .has-error, .has-warning, .has-feedback, .has-success").removeClass("at-required at-invalid at-success has-error has-warning has-feedback has-success")}function _ignore_this_element(el){var types_of_elements_to_ignore=["submit","reset","button","image"];return el.is("input")&&-1!==(el.is("input")&&$.inArray(el.prop("type"),types_of_elements_to_ignore))?!0:!1}var version="2.1.3",defaults={form_validate:"novalidate",form_autocomplete:"off",tag:"p",lost_focus:!0,highlight:{marker:"*",position:"post"},messages:{submit:"Wait ...",required:"Required field",invalid:"Field with invalid data",textarea_help:'Typed <span class="at-counter">{0}</span> of {1}'},use_filter:!0,before_validate:null,after_validate:null},filters={email:/^[\w!#$%&'*+\/=?^`{|}~-]+(\.[\w!#$%&'*+\/=?^`{|}~-]+)*@(([\w-]+\.)+[A-Za-z]{2,6}|\[\d{1,3}(\.\d{1,3}){3}\])$/,url:/^(http[s]?:\/\/|ftp:\/\/)?(www\.)?[a-zA-Z0-9-\.]+\.(com|org|net|mil|edu|ca|co.uk|com.au|gov|br|jp|co|in|me|la|ly)$/,number:/^([0-9])+$/,decimal:/^([0-9]{0,3}(\,|\.){0,1}){0,2}[0-9]{1,3}(\,[0-9]{2}|\.[0-9]{2}){0,1}$/,date_br:/^([0-9]|[0,1,2][0-9]|3[0,1])\/(0[1-9]|1[0,1,2])\/\d{4}$/,date:/^\d{4}-(0[0-9]|1[0,1,2])-([0,1,2][0-9]|3[0,1])$/,time:/^([0-1][0-9]|[2][0-3])(:([0-5][0-9])){1,2}$/,phone_br:/^\(?\d{2}\)?[\s-]?([9]){0,1}\d{4}-?\d{4}$/,phone_jp:/^(((\(0\d{1}\)[\s-]?|0\d{1}-?)[2-9]\d{3}|(\(0\d{2}\)[\s-]?|0\d{2}-?)[2-9]\d{2,3}|(\(0\d{3}\)[\s-]?|0\d{3}-?)[2-9]\d{1}|(\(0\d{4}\)[\s-]?|0\d{4}-?)[2-9])-?\d{4}|(\(0\d{3}\)[\s-]?|0\d{3}-?)[2-9]\d{2}-?\d{3})$/,zipcode_us:/^([A-Z][0-9]){3}$/,zipcode_br:/^[0-9]{2}\.{0,1}[0-9]{3}\-[0-9]{3}$/,zipcode_jp:/^[0-9]{3}\-?[0-9]{4}$/,valid_ip:/^\b(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\b$/,min_length:function(s,l){return s.length>=l},max_length:function(s,l){return s.length<=l},matches:function(a,b){try{b=$("#"+b).val()||b}catch(e){}return a==b},greater_than:function(v,r){return v.match(filters.number)&&r.match(filters.number)?parseInt(v,10)>parseInt(r,10):!1},less_than:function(v,r){return v.match(filters.number)&&r.match(filters.number)?parseInt(v,10)<parseInt(r,10):!1}},o={},methods={version:function(){return this.each(function(){$(this).html(version)})},init:function(options){return o=$.extend({},defaults,options),this.each(function(){var f=$(this);f.data("old-autocomplete",f.attr("autocomplete")),f.data("old-novalidate",f.attr("novalidate")),f.attr("autocomplete",o.autocomplete||o.form_autocomplete?o.autocomplete||o.form_autocomplete:"off"),f.attr("novalidate",o.novalidate||o.form_novalidate?o.novalidate||o.form_novalidate:"novalidate"),f.find("button[type=reset], input[type=reset]").each(function(i,el){$(el).on("click.valida",function(){_clear_all(),$("input, select, textarea").filter(":first").focus()})}),f.find("input, select, textarea").each(function(i,el){el=$(el),_ignore_this_element(el)||(el.is("[required]")&&null!==o.highlight&&o.highlight!==!1&&$("[for="+el.attr("id")+"]").html("pre"==o.highlight.position?'<span class="at-required-highlight" >'+o.highlight.marker+"</span>&nbsp;"+$("[for="+el.attr("id")+"]").html():$("[for="+el.attr("id")+"]").html()+'&nbsp;<span class="at-required-highlight" >'+o.highlight.marker+"</span>"),o.lost_focus&&el.on("blur.valida",function(){(el.is("select")&&el.is("[required]")&&(""===el.find("option").filter(":selected").val()||!el.find("option").length)||el.is("textarea")&&el.is("[required]")&&""===el.val()||el.is("input")&&"checkbox"===el.prop("type")&&el.is("[required]")&&!el.is(":checked")||el.is("input")&&"checkbox"!==el.prop("type")&&el.is("[required]")&&""===el.val())&&_show_error(el,el.is("[type=checkbox]"))}),el.is("textarea")&&el.attr("maxlength")&&(el.after($("<div />",{"class":"help-block at-description",html:(el.data("help")||(o.messages.textarea_help?o.messages.textarea_help:'Typed <span class="at-counter">{0}</span> of {1}')).replace("{1}",el.attr("maxlength")).replace("{0}",el.val().length)})),el.on("keyup.valida",function(e){_char_count(e,el,el.attr("maxlength"))}).on("keydown.valida",function(e){_char_count(e,el,el.attr("maxlength"))})),el.on("change.valida",function(){""!==el.val()&&el.is("select")&&_clear(el)}),el.is("input")&&"checkbox"===el.prop("type")&&el.is("[required]")?el.on("click.valida",function(){_clear(el),el.is(":checked")||_show_error(el,el.is("[type=checkbox]"))}):el.on("keyup.valida",function(){""!==el.val()&&_typing_handler(el)}).on("keydown.valida",function(){_typing_handler(el)}))}),f.on("submit.valida",function(e){var err=!1;if(_clear_all(),o.before_validate&&$.isFunction(o.before_validate)&&(err=!o.before_validate(e)),f.find("button[type=submit], input[type=submit]").each(function(i,el){el=$(el),el.prop("disabled",!0).data("old-value",el.is("input")?el.val():el.html()),el.is("input")?el.val(o.messages.submit||"Wait ..."):el.html(o.messages.submit||"Wait ...")}),f.find("input, select, textarea").each(function(i,el){el=$(el),err=!_partial_validation(el,!0,!1,err)}),o.after_validate&&$.isFunction(o.after_validate)&&(err=!o.after_validate(e,err)),err){e.preventDefault(),f.find("button[type=submit], input[type=submit]").each(function(i,el){el=$(el),el.prop("disabled",!1),el.is("input")?el.val(el.data("old-value")):el.html(el.data("old-value"))});var wmid=Math.ceil($(window).height()/2);return $(".at-required:visible, .at-invalid:visible").length>0&&$("html,body").animate({scrollTop:$(".at-required:visible, .at-invalid:visible").filter(":first").offset().top-wmid},"fast",function(){$(".at-required:visible, .at-invalid:visible").filter(":first").focus()}),!1}})})},destroy:function(){var f=$(this);f.attr("autocomplete",f.data("old-autocomplete")),f.attr("novalidate",f.data("old-novalidate")),f.find("button, input[type=reset]").off("valida"),f.find("button, input[type=reset]").unbind(".valida"),f.find("input, select, textarea").off("valida"),f.find("input, select, textarea").unbind(".valida"),f.find(".help-block.at-description").remove(),f.off("valida"),f.unbind(".valida"),f.valida=null},partial:function(el,show_error,force_clear){var err=_partial_validation(el,show_error,force_clear);if(err){var wmid=Math.ceil($(window).height()/2);$(".at-required:visible, .at-invalid:visible").length>1&&$("html,body").animate({scrollTop:$(".at-required:visible, .at-invalid:visible").filter(":first").offset().top-wmid},"fast",function(){$(".at-required:visible, .at-invalid:visible").filter(":first").focus()})}return err}};$.fn.valida=function(method){return methods[method]?methods[method].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof method&&method?void $.error("Method "+method+" does not exist on jQuery.valida()"):methods.init.apply(this,arguments)}}(jQuery);